<!DOCTYPE html>
<html>
    <link href='https://fonts.googleapis.com/css?family=Rubik' rel='stylesheet'>
    <style>
        html {
             background-repeat: no-repeat;
             background-attachment: fixed;
             background-color: #001e34;
        }

        body {
            font-family: Rubik;
            color: white;
            accent-color: #d81466;
            background-color: #001e34;
            background-image: linear-gradient(#40b7e638, #001e34);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 400px));
            padding: 2rem;
        }   

        .groupHeader {
            color: #40b6e6
        }

        .titleRow {
            display: flex;
            justify-content: center;
        }

        .title {
            font-size: 2rem;
            font-weight: bold;
        }

        .defaultButton {
            background-color: #40b6e6;
            border: none;
            border-radius: 4px;
            color: #001e34;
            padding: 0.5rem;
            margin-left: 2rem;
            margin-right: 2rem;
            text-align: center;
            font-size: 16px;
        }

        .result {
            font-size: 2rem;
            font-weight: bold;
            display: flex;
            justify-content: center;
            margin: 1rem;
        }

        .info {
            color: #40b6e6;
            display: flex;
            justify-content: center;
            margin-top: 0;
            margin-bottom: 0;
        }

        .exclusion {
            color: #40b6e6;
            display: flex;
            justify-content: center;
            margin-top: 0;
            margin-bottom: 0;
        }

        .adaptedRow {
            display: flex;
            justify-content: center;
            margin-top:2rem;
        }

        .adapted {
            display: flex;
            font-size: 0.8rem;
            justify-content: center;
            text-align: center;
            margin-top:2rem;
            max-width: 600px;
        }

    </style>

    <head>
    </head>

    <body>
        <div class="main">
            <div class="titleRow">
                <p class="title">
                    JIA Subtype Calculator
                </p>
            </div>

            <div class="grid">  
                <div>
                    <p class="groupHeader">Sex</p>
                    <input type="radio" name="sex" id="male" onclick="evalSubtype()" checked>
                    <label for="male">Male</label><br>
            
                    <input type="radio" name="sex" id="female" onclick="evalSubtype()">
                    <label for="female">Female</label><br>
                </div>

                <div>
                    <p class="groupHeader">Age at Arthritis Onset</p>
                    <input type="radio" name="age" id="fiveOrYounger" onclick="evalSubtype()" checked>
                    <label for="fiveOrYounger">0 - 5 years old</label><br>
            
                    <input type="radio" name="age" id="sixOrOlder" onclick="evalSubtype()">
                    <label for="sixOrOlder">6 years old or greater</label><br>
                </div>

                <div>
                    <p class="groupHeader">Number of Joints</p>
                    <input type="radio" name="numberOfJoints" id="zero" onclick="evalSubtype()">
                    <label for="zero">0</label><br>
            
                    <input type="radio" name="numberOfJoints" id="oneToFour" onclick="evalSubtype()" checked>
                    <label for="oneToFour">1 - 4</label><br>

                    <input type="radio" name="numberOfJoints" id="fiveOrMore" onclick="evalSubtype()">
                    <label for="fiveOrMore">5 or more</label><br>
                </div>

                <div>
                    <p class="groupHeader">Inflammatory Bowel Disease</p>
                    <input type="checkbox" id="ibd" name="ibd" onclick="evalSubtype()">
                    <label for="ibd">IBD in patient</label><br>
                </div>

                <div>
                    <p class="groupHeader">Rheumatoid Factor</p>
                    <input type="radio" name="rf" id="rfNegative" onclick="evalSubtype()" checked>
                    <label for="rfNegative">a test for rheumatoid factor is negative</label><br>
            
                    <input type="radio" name="rf" id="rfPositive" onclick="evalSubtype()">
                    <label for="rfPositive">≥2 tests for rheumatoid factor ≥3 months apart are positive in the 1st 6 months of disease</label><br>

                    <input type="radio" name="rf" id="neither" onclick="evalSubtype()">
                    <label for="neither">neither</label><br>
                </div>

                <div>
                    <p class="groupHeader">Systemic Arthritis</p>
                    <input type="checkbox" id="fever" name="fever" onclick="evalSubtype()">
                    <label for="fever">Daily fever of ≥2 weeks duration</label><br>

                    <input type="checkbox" id="rash" name="rash" onclick="evalSubtype()">
                    <label for="rash">Evanescent, erythematous rash</label><br>

                    <input type="checkbox" id="lad" name="lad" onclick="evalSubtype()">
                    <label for="lad">Generalized lymph node enlargement</label><br>

                    <input type="checkbox" id="hsm" name="hsm" onclick="evalSubtype()">
                    <label for="hsm">Hepatomegaly and/or splenomegaly</label><br>

                    <input type="checkbox" id="serositis" name="serositis" onclick="evalSubtype()">
                    <label for="serositis">Serositis</label><br>
                </div>

                <div>
                    <p class="groupHeader">Psoriasis</p>
                    <input type="checkbox" id="psoriasis" name="psoriasis" onclick="evalSubtype()">
                    <label for="psoriasis">Psoriasis in patient</label><br>

                    <input type="checkbox" id="dactylitis" name="dactylitis" onclick="evalSubtype()">
                    <label for="dactylitis">Dactylitis</label><br>

                    <input type="checkbox" id="nailPitting" name="nailPitting" onclick="evalSubtype()">
                    <label for="nailPitting">Nail pitting or onycholysis</label><br>

                    <input type="checkbox" id="psoriasisInFamily" name="psoriasisInFamily" onclick="evalSubtype()">
                    <label for="psoriasisInFamily">Psoriasis in 1st degree relative</label><br>
                </div>

                <div>
                    <p class="groupHeader">Enthesitis</p>
                    <input type="checkbox" id="enthesitis" name="enthesitis" onclick="evalSubtype()">
                    <label for="enthesitis">Enthesitis in patient</label><br>

                    <input type="checkbox" id="siPain" name="siPain" onclick="evalSubtype()">
                    <label for="siPain">Sacroiliac joint tenderness and/or inflammatory lumbosacral pain</label><br>

                    <input type="checkbox" id="hlab27" name="hlab27" onclick="evalSubtype()">
                    <label for="hlab27">Presence of HLA-B27 antigen</label><br>

                    <input type="checkbox" id="uveitis" name="uveitis" onclick="evalSubtype()">
                    <label for="uveitis">Acute anterior uveitis</label><br>

                    <input type="checkbox" id="spondyInFamily" name="spondyInFamily" onclick="evalSubtype()">
                    <label for="spondyInFamily">History of spondyloarthritis or acute anterior uveitis in 1st degree relative</label><br>
                </div>
            </div>

            <div class="defaultRow">
                <button class="defaultButton" onclick="defaultSelections()">Reset</button>
            </div>

            <div>
                <p id="result" class="result">
                    Oligoarthritis
                </p>
                <p id="info" class="info">
                </p>
                <p id="exclusion" class="exclusion">
                </p>
            </div>

            <div class="adaptedRow">
                <div class="adapted">
                    <p>
                        Adapted from:<br>
                        Petty RE, Southwood TR, Manners P, et al. International League of Associations for Rheumatology classification of juvenile idiopathic arthritis: second revision, Edmonton, 2001. J Rheumatol 2004;31:390-2.<br><br>
                        Eddie Re | 2024 | ree@chop.edu
                    </p>
                </div>
            </div>


        </div>

        <script>
            function evalSubtype() {
                let isMale = document.getElementById("male").checked;
                let isSixYearsOld = document.getElementById("sixOrOlder").checked;

                let zeroJoints = document.getElementById("zero").checked;
                let oneToFourJoints = document.getElementById("oneToFour").checked;
                let fiveOrMoreJoints = document.getElementById("fiveOrMore").checked;

                let hasIBD = document.getElementById("ibd").checked;

                let rfNeg = document.getElementById("rfNegative").checked;
                let rfPos = document.getElementById("rfPositive").checked;
                let rfNeither = document.getElementById("neither").checked;

                let hasFever = document.getElementById("fever").checked;
                let hasRash = document.getElementById("rash").checked;
                let hasLAD = document.getElementById("lad").checked;
                let hasHSM = document.getElementById("hsm").checked;
                let hasSerositis = document.getElementById("serositis").checked;

                let hasPsoriasis = document.getElementById("psoriasis").checked;
                let hasDactylitis = document.getElementById("dactylitis").checked;
                let hasNailPitting = document.getElementById("nailPitting").checked;
                let hasPsoriasisInFamily = document.getElementById("psoriasisInFamily").checked;

                let hasEnthesitis = document.getElementById("enthesitis").checked;
                let hasSIPain = document.getElementById("siPain").checked;
                let hasHLA2B7 = document.getElementById("hlab27").checked;
                let hasUveitis = document.getElementById("uveitis").checked;
                let hasSpondyInFamily = document.getElementById("spondyInFamily").checked;

                let hasArthritis = oneToFourJoints || fiveOrMoreJoints;
                let has2ERASubcriteria = (hasSIPain ? 1 : 0) + 
                                         (hasHLA2B7 ? 1 : 0) +
                                         (hasUveitis ? 1 : 0) +
                                         (hasSpondyInFamily ? 1 : 0) >= 2;

                let has2PsoriasisSubcriteria = (hasDactylitis ? 1 : 0) + 
                                               (hasNailPitting ? 1 : 0) +
                                               (hasPsoriasisInFamily ? 1 : 0) >= 2;

                let hasERA = (hasArthritis && hasEnthesitis) || ((hasArthritis || hasEnthesitis) && has2ERASubcriteria)

                let hasSJIA = hasArthritis && hasFever && (hasRash || hasLAD || hasHSM || hasSerositis);

                let hasExclusionA = hasPsoriasis || hasPsoriasisInFamily;
                let hasExclusionB = hasArthritis && isMale && isSixYearsOld && hasHLA2B7;
                let hasExclusionC = hasERA || hasSpondyInFamily;
                let hasExclusionD = rfPos;
                let hasExclusionE = hasSJIA;

                let fulfilledCriteria = 0;
                let exclusions = [];

                if (hasSJIA)
                {
                    if (hasExclusionA || hasExclusionB || hasExclusionC || hasExclusionD)
                    {
                        exclusions.push("Systemic Arthritis");
                    }
                    else
                    {
                        fulfilledCriteria += 1;
                        document.getElementById("result").innerHTML = "Systemic Arthritis";
                    }
                }

                if (oneToFourJoints)
                {
                    if (hasExclusionA || hasExclusionB || hasExclusionC || hasExclusionD || hasExclusionE)
                    {
                        exclusions.push("Oligoarthritis");
                    }
                    else
                    {
                        fulfilledCriteria += 1;
                        document.getElementById("result").innerHTML = "Oligoarthritis";
                    }
                }

                if (fiveOrMoreJoints && rfNeg)
                {
                    if (hasExclusionA || hasExclusionB || hasExclusionC || hasExclusionD || hasExclusionE)
                    {
                        exclusions.push("RF Negative Polyarthritis");
                    }
                    else
                    {
                        fulfilledCriteria += 1;
                        document.getElementById("result").innerHTML = "RF Negative Polyarthritis";
                    }
                }

                if (fiveOrMoreJoints && rfPos)
                {
                    if (hasExclusionA || hasExclusionB || hasExclusionC || hasExclusionE)
                    {
                        exclusions.push("RF Positive Polyarthritis");
                    }
                    else
                    {
                        fulfilledCriteria += 1;
                        document.getElementById("result").innerHTML = "RF Positive Polyarthritis";
                    }
                }

                if (hasArthritis && (hasPsoriasis || has2PsoriasisSubcriteria))
                {
                    if (hasExclusionB || hasExclusionC || hasExclusionD || hasExclusionE)
                    {
                        exclusions.push("Psoriatic Arthritis");
                    }
                    else
                    {
                        fulfilledCriteria += 1;
                        document.getElementById("result").innerHTML = "Psoriatic Arthritis";
                    }
                }

                if (hasERA)
                {
                    if (hasExclusionA || hasExclusionD || hasExclusionE)
                    {
                        exclusions.push("Enthesitis Related Arthritis");
                    }
                    else
                    {
                        fulfilledCriteria += 1;
                        document.getElementById("result").innerHTML = "Enthesitis Related Arthritis";
                    }
                }

                if (hasArthritis && fulfilledCriteria == 1)
                {
                    document.getElementById("info").innerHTML = "Fulfills criteria for " + fulfilledCriteria + " differentiated JIA subtype(s).";
                }

                if (hasArthritis && fulfilledCriteria != 1)
                {
                    document.getElementById("result").innerHTML = "Undifferentiated Arthritis";
                    document.getElementById("info").innerHTML = "Fulfills criteria for " + fulfilledCriteria + " differentiated JIA subtype(s).";
                }

                if (!hasArthritis && fulfilledCriteria <= 0)
                {
                    document.getElementById("result").innerHTML = "No Arthritis";
                    document.getElementById("info").innerHTML = "Fulfills criteria for " + fulfilledCriteria + " differentiated JIA subtype(s).";
                }

                if (hasArthritis && hasIBD)
                {
                    document.getElementById("result").innerHTML = "IBD-Associated Arthritis";
                    document.getElementById("infoText").innerHTML = "Excluded from JIA classification but otherwise would fulfill criteria for " + fulfilledCriteria + " differentiated JIA subtype(s).";
                }

                if (!hasIBD && exclusions.length > 0)
                {
                    document.getElementById("exclusion").innerHTML = "Exclusion criteria for " + exclusions.join(", ") + " present.";
                }
                else
                {
                    document.getElementById("exclusion").innerHTML = "";
                }
            }

            function defaultSelections() {
                document.querySelectorAll('input[type=checkbox]').forEach(el => el.checked = false);

                document.getElementById("male").checked = true;
                document.getElementById("fiveOrYounger").checked = true;
                document.getElementById("oneToFour").checked = true;
                document.getElementById("rfNegative").checked = true;

                evalSubtype();
            }

            window.onload = defaultSelections();
        </script>
    </body>
</html>